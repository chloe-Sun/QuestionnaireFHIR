<!-- <!DOCTYPE html> -->
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Launch Page</title>
        <link rel="stylesheet" href="./css/style.css"/> 
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
        <div class = "app">
            <div class = "header">
            </div>
            <div class = "content">
                <img src = "./images/homePic.jpg"class = "home_img"/>
                <button id=login type="submit" class = "button" >Login</button>
            </div>
            
            <p class = "copyright">Copyright @ COMP3001-G6</p>
        </div>
    </body>
    <script src="fhir-client.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
    function login() {
        // var httpRequest = new XMLHttpRequest();
        // httpRequest.open('GET', 'https://uat.csiro.au/fhirServerR4/fhir/metadata', true);
        // httpRequest.send();
        // httpRequest.onreadystatechange = function () {
        //     if (httpRequest.readyState == 4 && httpRequest.status == 200) {
        //         var json = JSON.parse(httpRequest.responseText);
        //         console.log(json);
        //         var uri = json.rest[0].security.extension[0].extension[0].valueUri;
        //         var requestUrl = uri + "?client_id=G6&scope=launch openid fhirUser patient/*.* user/*.*&redirect_url=https://https://chloe-sun.github.io/QuestionnaireFHIR/launch";
        //         window.location.replace(url)
        //     }
                //         $.ajax({
        //             url: requestUrl,
        //             type: 'get',
        //             dataType: 'jsonp'

        //         })
                // var request = new XMLHttpRequest();
                // request.open('GET',url,true);
                // request.send();
                
                // var page = request.responseText;
                // console.log(page);
        //     }
        // };
        FHIR.oauth2.authorize({
            'clientId': 'G6',
            'scope': 'launch/patient openid patient/*.* user/*.* fhirUser',
            // 'iss' :'https://launch.smarthealthit.org/v/r4/sim/eyJoIjoiMSIsImIiOiJkYmY5Nzk4ZS00YjUyLTRjZDktYTllYi1lYzM2MTQ5Yzg1OWEiLCJlIjoiZWZiNWQ0Y2UtZGZmYy00N2RmLWFhNmQtMDVkMzcyZmRiNDA3In0/fhir'
            'iss':'https://uat.csiro.au/fhirServerR4/fhir'
        });
    }
    document.getElementById("login").addEventListener("click",login);
    </script>
</html>
